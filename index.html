<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scanner to Google Sheets</title>
</head>
<body>
    <h2>Scanner to Google Sheets</h2>
    <label>Jm√©no u≈æivatele:</label>
    <input type="text" id="user" placeholder="Zadejte jm√©no" required>
    <br>
    <label>ƒå√°rov√© k√≥dy:</label><br>
    <input type="text" id="code1" autofocus><br>
    <input type="text" id="code2"><br>
    <input type="text" id="code3"><br>
    <input type="text" id="code4"><br>
    <input type="text" id="code5"><br>
    <input type="text" id="code6" onkeydown="checkSubmit(event)"><br>
    <button onclick="sendData()">Ulo≈æit</button>

    <script>
        function checkSubmit(event) {
            if (event.key === "Tab" || event.key === "Enter") {
                event.preventDefault(); // Zabr√°n√≠ p≈ôeskoƒçen√≠ do dal≈°√≠ho pole
                sendData();
            }
        }

        async function sendData() {
    const user = document.getElementById('user').value;
    const codes = [];
    for (let i = 1; i <= 6; i++) {
        codes.push(document.getElementById(`code${i}`).value);
    }

    if (!user || codes.every(code => code === "")) {
        alert("Vypl≈àte jm√©no a alespo≈à jedno pole ƒç√°rov√©ho k√≥du.");
        return;
    }

    const data = { user, codes };

    try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbztafQYBFcLRef7-T6TqCBVAig3TqB8GeuwEVBTS6eOLkk5iTlwn3x34iLXD3jiBxsB/exec', { // üìå Pou≈æij spr√°vnou URL
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.status === "success") {
            alert("√öspƒõ≈°nƒõ odesl√°no!");
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`code${i}`).value = "";
            }
        } else {
            alert("Chyba p≈ôi odes√≠l√°n√≠ dat.");
        }
    } catch (error) {
        console.error(error);
        alert("Chyba p≈ôipojen√≠ k serveru.");
    }
}

        
    </script>
</body>
</html>
